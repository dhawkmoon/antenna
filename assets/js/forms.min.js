function startLoading(e){e.addClass("loading"),e.find("button").prop("disabled",!0)}function printSuccess(e,o){e.append('<span class="message message-success">'+o+'</span><span class="m-modal-overlay"></span>')}function printError(e,o){e.append('<span class="message message-error">'+o+'</span><span class="m-modal-overlay"></span>')}function clearForm(e){e.find("[disabled]").prop("disabled",!1),e.removeClass("loading")}function dismissMessage(){$(".m-modal-overlay,.message").remove()}function send(e,o){var s=new FormData(e[0]);s.append("form",e.attr("id")),s.append("url",window.location.search.replace(/&/g,"-_-")),$.ajax({url:"/backend/"+o,type:"POST",data:s,context:e,processData:!1,contentType:!1,success:function(e){setTimeout(printSuccess,2e3,$(this),e),setTimeout(clearForm,2e3,$(this)),setTimeout(dismissMessage,6e3),dataLayer.push({event:"formsend",eventCategory:"form",eventAction:"send-btn",eventLabel:$(this).attr("id")})},error:function(e){setTimeout(printError,2e3,$(this),e.responseText),setTimeout(clearForm,2e3,$(this)),setTimeout(dismissMessage,6e3)}})}var phone={value:"",placeholder:"+7 (xxx) xxx-xx-xx",validate:{required:{error:"Укажите, пожалуйста, Ваш телефон"},pattern:{reg:/^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\- ]?)?[\d\- ]{10}$/,error:"Укажите номер телефона в правильном формате"}}},warranty={value:"Да",validate:{callback:function(e){return"Да"==e||""==e||{error:"Некорректный формат поля гарантии"}}}},qty={value:1,validate:{pattern:{reg:/^\d*$/,error:"Данное поле может содержать только цифры"}}},models={value:"",validate:{max:{treshold:60,error:"Максимальная длина поля 60 символов"}}},photo={value:"",validate:{pattern:{reg:/\.(jp(e)?g|png)$/,error:"Загрузите фото в формате jpg или png."}}},forms=[{id:"s1-form",fields:{"s1-form-phone":phone,"s1-form-check":warranty}},{id:"s1-form-mobile",fields:{"s1-form-mobile-phone":phone,"s1-form-mobile-check":warranty}},{id:"s3-form",fields:{"s3-form-phone":phone,"s3-form-check":warranty}},{id:"s3-form-mobile",fields:{"s3-form-mobile-phone":phone,"s3-form-mobile-check":warranty}},{id:"s5-form",fields:{"s5-form-phone":phone,"s5-form-check":warranty}},{id:"s8-form",fields:{"s8-form-phone":phone,"s8-form-check":warranty}},{id:"modal-form",fields:{"modal-form-qty":qty,"modal-form-models":models,"modal-form-photo":photo,"modal-form-phone":phone},onFormSuccess:function(e){startLoading($(e)),send($(e),"detailed")}}],onFieldError=function(e,o){e.removeClass("has-success"),e.addClass("has-error")},onSubmitError=function(e,o){e.siblings(".form-error").text(o.error),e.removeClass("has-success"),e.addClass("has-error")},onSuccess=function(e){e.siblings(".form-error").text(""),e.removeClass("has-error"),e.addClass("has-success")},onFormSuccess=function(e){startLoading($(e)),send($(e),"send")};validateUs(forms),$(".form-error").on("click",function(){$(this).text("")}),$("body").on("overlayremoved",function(){$(".message").remove()}),$("input[type=checkbox]").on("change",function(){1==$(this).prop("checked")?dataLayer.push({event:"checkboxEvent",eventCategory:"checkbox",eventAction:"setTrue",eventLabel:$(this).attr("id")}):dataLayer.push({event:"checkboxEvent",eventCategory:"checkbox",eventAction:"setFalse",eventLabel:$(this).attr("id")})});